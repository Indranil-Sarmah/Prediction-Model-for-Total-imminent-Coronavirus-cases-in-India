# -*- coding: utf-8 -*-
"""Using polynomial regression for predicting the Total imminent Coronavirus cases in India.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/github/Indranil-Sarmah/Prediction-Model-for-Total-imminent-Coronavirus-cases-in-India/blob/master/Using_polynomial_regression_for_predicting_the_Total_imminent_Coronavirus_cases_in_India.ipynb
"""

import pandas as pd
df = pd.read_csv("owid-covid-data.csv")

df

df.head(5)

df = df.loc[df["location"].isin(["India"])]

df

df.columns

df = df[["location","total_cases","new_cases"]]
df.head()

df.tail()

df = df.reset_index()
df["index"]=df.index

df

import matplotlib.pyplot as plt

df.info()

plt.plot(df["total_cases"],label = "Actual Total cases")
plt.xlabel("No. of days")
plt.ylabel("Total cases")
plt.legend()
plt.show()

plt.plot(df["new_cases"],label = "New Cases")
plt.xlabel("No. of days")
plt.ylabel("New cases")
plt.legend()
plt.show()

"""## **Prediction Model** """

from google.colab import drive
drive.mount('/content/drive')

from sklearn.preprocessing import  PolynomialFeatures
from sklearn.linear_model import LinearRegression
import numpy as np

X = np.array(df["index"]).reshape(-1,1)
y = np.array(df["total_cases"]).reshape(-1,1)

poly = PolynomialFeatures(degree=6)
X=poly.fit_transform(X)

lin_reg=LinearRegression()
lin_reg.fit(X,y)
lin_reg.score(X,y)

"""**Accuray of the model : 99.87%**"""

plt.plot(df["total_cases"],label = "Actual Total cases")
plt.plot(lin_reg.predict(X),"r--",label = "Predicted Total cases")
plt.title("comparision between Prediction model cases and Actual Cases ")
plt.xlabel("No of days")
plt.ylabel("Total cases")
plt.legend() 
plt.show()

"""**For prediction of a sample data use :**

lin_reg.predict(poly.fit_transform([409]))
"""

lin_reg.predict(poly.fit_transform([[415]]))